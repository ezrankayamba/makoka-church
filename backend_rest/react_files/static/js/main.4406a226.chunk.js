(this.webpackJsonpfrontend_web=this.webpackJsonpfrontend_web||[]).push([[0],{52:function(e,t,a){e.exports=a(65)},65:function(e,t,a){"use strict";a.r(t);var n=a(0),r=a.n(n),l=a(23),c=a.n(l),o=a(8),u=a(5),i=a(15),m=a(12);function s(){var e=Object(i.a)(["\n  query getUser($id: ID!) {\n    user(id: $id) {\n      id\n      username\n      dateJoined\n      firstName\n      lastName\n      lastLogin\n      email\n      isStaff\n      isSuperuser\n    }\n  }\n"]);return s=function(){return e},e}function d(){var e=Object(i.a)(["\n  mutation registerUser(\n    $id: ID\n    $username: String!\n    $email: String!\n    $firstName: String\n    $lastName: String\n  ) {\n    registerUser(\n      id: $id\n      username: $username\n      email: $email\n      firstName: $firstName\n      lastName: $lastName\n    ) {\n      user {\n        id\n        username\n        dateJoined\n        firstName\n        lastName\n        lastLogin\n        email\n        isStaff\n        isSuperuser\n      }\n    }\n  }\n"]);return d=function(){return e},e}function b(){var e=Object(i.a)(["\n  query getUsers {\n    users {\n      id\n      username\n      dateJoined\n      firstName\n      lastName\n      lastLogin\n      email\n      isStaff\n      isSuperuser\n    }\n  }\n"]);return b=function(){return e},e}function f(){var e=Object(i.a)(["\n  query getMe {\n    me {\n      id\n      username\n      dateJoined\n      firstName\n      lastName\n      lastLogin\n      email\n      isStaff\n      isSuperuser\n    }\n  }\n"]);return f=function(){return e},e}function E(){var e=Object(i.a)(["\n  mutation getToken($username: String!, $password: String!) {\n    tokenAuth(username: $username, password: $password) {\n      token\n    }\n  }\n"]);return E=function(){return e},e}var p=Object(m.b)(E()),v=Object(m.b)(f()),g=Object(m.b)(b()),O=Object(m.b)(d()),h=Object(m.b)(s());var y=function(e){var t=Object(u.c)(v),a=t.loading,n=t.error,l=t.data;return a?r.a.createElement("p",null,"Loading..."):n?r.a.createElement("p",null,"Error :("):(console.log(l),r.a.createElement("div",{className:"user-profile-nav"},r.a.createElement("ul",null,r.a.createElement("li",null,r.a.createElement("b",null,l.me.username)),r.a.createElement("li",null,r.a.createElement(o.b,{exact:!0,to:"/login"},"Logout")))))},j=a(7);var N=function(){var e=Object(j.g)(),t=Object(u.c)(v),a=t.loading,n=t.error,r=t.data;if(a)return null;if(n){if(n.graphQLErrors.length){var l=n.graphQLErrors[0].message;"Signature has expired"!==l&&"You do not have permission to perform this action"!==l||e.push("/login")}return console.log(n),null}return r},S={DEV:{baseUrl:"http://localhost:8000/api",ROOT:"http://localhost:8000"},PROD:{baseUrl:"/api",ROOT:""}},w=S.PROD.baseUrl;S.PROD.ROOT;var k=function(){var e=N();return console.log(e),r.a.createElement("header",{className:"navbar container"},r.a.createElement("div",{className:"content"},r.a.createElement("h3",null,"TAG MAKOKA (MSCC)"),r.a.createElement("div",{className:"nav-links"},r.a.createElement("ul",null,r.a.createElement("li",null,r.a.createElement(o.b,{exact:!0,to:"/"},"Home")),r.a.createElement("li",null,r.a.createElement(o.b,{to:"/entries"},"Entries")),e&&e.me&&e.me.isSuperuser&&r.a.createElement("li",null,r.a.createElement(o.b,{to:"/users"},"Users"))),r.a.createElement(y,null))))};function C(){var e=Object(i.a)(["\n  query kpi {\n    kpiSummary {\n      name\n      count\n      natureName\n    }\n  }\n"]);return C=function(){return e},e}function x(){var e=Object(i.a)(["\n  query getLocSummary {\n    locationSummary {\n      locName\n      locCount\n    }\n  }\n"]);return x=function(){return e},e}function A(){var e=Object(i.a)(["\n  query statusSummary {\n    statusSummary {\n      name\n      count\n    }\n  }\n"]);return A=function(){return e},e}function $(){var e=Object(i.a)(["\n  query natureSummary {\n    natureSummary {\n      name\n      status\n      count\n    }\n  }\n"]);return $=function(){return e},e}var q=Object(m.b)($()),T=Object(m.b)(A()),D=Object(m.b)(x()),F=Object(m.b)(C()),L=a(26),I=a.n(L),M=function(e){return isNaN(e)?0:parseFloat(e)},U={fmt:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;return Number(e).toFixed(t).toString().replace(/(\d)(?=(\d{3})+(?!\d))/g,"$1,")},sum:function(e){return e.reduce((function(e,t){return M(e)+M(t)}),0)},dpts:function(e){return(Math.round(100*e)/100).toFixed(2)}},R=function(e){var t=e.graphId,a=e.meta,l=e.title,c=e.extra,o=void 0===c?null:c,u=e.type,i=void 0===u?"bar":u,m=e.stacked,s=void 0!==m&&m;return Object(n.useEffect)((function(){var e={datasets:a.data,labels:a.labels};console.log(e);var n={legend:{display:window.screen.width>800,position:"top"},plugins:{datalabels:{display:!1}},hover:{mode:"index",intersect:!1},tooltips:{displayColors:!0,callbacks:{mode:"x"}},scales:{xAxes:[{stacked:s,gridLines:{display:!1}}],yAxes:[{stacked:s,ticks:{beginAtZero:a.beginAtZero||!1,callback:function(e){return e.toLocaleString()},userCallback:function(e,t,a){if(Math.floor(e)===e)return e}},type:"linear"}]}};new I.a(document.getElementById(t),{type:i,data:e,options:n})}),[]),r.a.createElement("div",{className:"graph-container bg-white card ".concat(o||"")},r.a.createElement("h6",{className:"pl-1"},l),r.a.createElement("div",null,r.a.createElement("canvas",{id:t,className:"graph p-1",style:{}})))},_=(a(42),a(51)),V=a(48),P=a.n(V),Q={randomColor:function(){for(var e="#",t=0;t<6;t++)e+="0123456789ABCDEF"[Math.floor(16*Math.random())];return e},randomColors:function(e){var t=this;return Object(_.a)(Array(e).keys()).map((function(){return t.randomColor()}))},contrastColors:function(e){return e.map((function(e){return P()(e)}))}};var z=function(e){N();var t=Object(u.c)(q),a=t.loading,n=t.data,l=t.error;if(a)return null;if(l)return null;console.log(n),console.log(n.natureSummary);var c=n.natureSummary.map((function(e){return e.name})).filter((function(e,t,a){return a.indexOf(e)===t})),o={data:[{name:"Not Assigned",count:0},{name:"Assigned",count:0},{name:"Completed",count:0},{name:"Feedback Sent",count:0}].map((function(e){return{label:e.name,backgroundColor:Q.randomColor(),data:c.map((function(t){var a=n.natureSummary.find((function(a){return a.name===t&&a.status===e.name}));return a?a.count:0}))}})),labels:c.map((function(e){return e})),beginAtZero:!0};return r.a.createElement(R,{stacked:!0,meta:o,title:"Complaints Nature Summary",graphId:"complaints-nature-summary"})},B=function(e){var t=e.meta,a=e.graphId,l=e.title,c=e.colors,o=e.onDataClick;return Object(n.useEffect)((function(){var e=c||Q.randomColors(t.data.length),n={legend:{position:"right"},plugins:{datalabels:{formatter:function(e,t){var a=0;return t.chart.data.datasets[0].data.map((function(e){a+=e})),(100*e/a).toFixed(0)+"%"},color:Q.contrastColors(e)}},onClick:function(e,a){if(a&&a.length&&o){var n=t.data.slice(a[0]._index,a[0]._index+1)[0];o(n)}}},r={datasets:[{data:t.data.map((function(e){return e.value})),backgroundColor:e}],labels:t.data.map((function(e){return e.name}))},l=new I.a(document.getElementById(a),{type:"pie",data:r,options:n});console.log(l)}),[]),r.a.createElement("div",{className:"graph-container bg-white card p-2"},r.a.createElement("h6",{className:"pl-1"},l),r.a.createElement("div",null,r.a.createElement("canvas",{id:a,className:"graph p-1",style:{}})))};var J=function(){N();var e=Object(u.c)(T),t=e.loading,a=e.data,n=e.error;if(t)return null;if(n)return null;console.log(a);var l={data:a.statusSummary.map((function(e){return{name:e.name,value:e.count}}))};return r.a.createElement(B,{meta:l,title:"Complaints Status Summary",graphId:"complaints-status-summary"})};var K=function(){N();var e=Object(u.c)(D),t=e.loading,a=e.data,n=e.error;if(t)return null;if(n)return null;var l={data:a.locationSummary.map((function(e){return{name:e.locName,value:e.locCount}}))};return r.a.createElement(B,{meta:l,title:"Complaints Location Summary",graphId:"complaints-location-summary"})};var Z=function(){N();var e=Object(u.c)(F),t=e.loading,a=e.data,n=e.error;if(t)return null;if(n)return null;console.log(a);var l=[{name:"1 week",count:0},{name:"2 weeks",count:0},{name:"3-4 weeks",count:0},{name:"5-6 weeks",count:0},{name:"7-8 weeks",count:0},{name:"Above 8 weeks",count:0}];console.log(a.kpiSummary);var c={data:a.kpiSummary.map((function(e){return e.natureName})).filter((function(e,t,a){return a.indexOf(e)===t})).map((function(e){return{label:e,backgroundColor:Q.randomColor(),data:l.map((function(t){var n=a.kpiSummary.find((function(a){return a.natureName===e&&a.name===t.name}));return n?n.count:0}))}})),labels:l.map((function(e){return e.name})),beginAtZero:!0};return r.a.createElement(R,{stacked:!0,meta:c,title:"Complaints KPI",graphId:"complaints-kpi-summary"})};var G=function(){return r.a.createElement("div",{className:"dashboard"},r.a.createElement(J,null),r.a.createElement(K,null),r.a.createElement(z,null),r.a.createElement(Z,null))},W=a(14),H=a(4),Y=a(6);var X=function(e){var t=e.columns,a=e.data,n=e.idCol,l=void 0===n?"id":n;return r.a.createElement("div",{className:"table-container"},r.a.createElement("table",{className:"table-scrollable"},r.a.createElement("thead",null,r.a.createElement("tr",null,t.map((function(e){return r.a.createElement("th",{key:e.name},e.label)})))),r.a.createElement("tbody",null,a.map((function(e){return r.a.createElement("tr",{key:e[l]},t.map((function(t){return r.a.createElement("td",{key:t.name,className:t.className},t.render?t.render(e):e[t.name])})))})))))},ee=function(e){var t=e.name,a=e.extra,n=e.text;return r.a.createElement(r.a.Fragment,null,r.a.createElement("span",{className:"mat-icon material-icons".concat(a?" "+a:"")},t),n&&r.a.createElement("span",null,n))};function te(){var e=Object(i.a)(["\n  mutation createEntity($name: String!) {\n    createEntity(input: { name: $name }) {\n      result {\n        id\n      }\n    }\n  }\n"]);return te=function(){return e},e}function ae(){var e=Object(i.a)(["\n  mutation createEntry($entity: ID!, $amount: Float!, $entryType: Int!, $createdAt: DateTime!) {\n    createEntry(input: { entity: $entity, amount: $amount, entryType: $entryType, createdAt: $createdAt }) {\n      result {\n        id\n      }\n    }\n  }\n"]);return ae=function(){return e},e}function ne(){var e=Object(i.a)(["\n  query getEntities {\n    entities {\n      id\n      name\n    }\n  }\n"]);return ne=function(){return e},e}function re(){var e=Object(i.a)(["\n  query getEntries(\n    $pageNo: Int\n    $pageSize: Int\n    $entity: Int\n    $dateFrom: Date\n    $dateTo: Date\n  ) {\n    entries(\n      pageNo: $pageNo\n      pageSize: $pageSize\n      entity: $entity\n      dateFrom: $dateFrom\n      dateTo: $dateTo\n    ) {\n      id\n      amount\n      entryType\n      createdAt\n      updatedAt\n      entity {\n        id\n        name\n      }\n    }\n  }\n"]);return re=function(){return e},e}var le=Object(m.b)(re()),ce=Object(m.b)(ne()),oe=Object(m.b)(ae()),ue=Object(m.b)(te()),ie=a(17),me=a(32),se=a(25);var de=function(e){var t=e.label,a=e.name,n=e.help,l=e.type,c=void 0===l?"text":l,o=e.cls,u=Object(se.a)(e,["label","name","help","type","cls"]);return r.a.createElement("div",{className:"input-wrap ".concat(o||"")},r.a.createElement("label",{htmlFor:a},t),"textarea"===c?r.a.createElement("textarea",Object.assign({name:a,id:a},u)):r.a.createElement("input",Object.assign({type:c,name:a,id:a},u,{autoComplete:!1})),n&&r.a.createElement("span",{className:"input-help"},n))},be={pageSize:10,pageNo:1},fe={pageSize:1e4,pageNo:1},Ee=a(50);var pe=function(e){var t=e.label,a=e.name,n=e.query,l=e.onCreateOption,c=e.onChange,o=e.options,i=void 0===o?[]:o,m=e.defaultValue,s=void 0===m?null:m,d=Object(se.a)(e,["label","name","query","onCreateOption","onChange","options","defaultValue"]),b=Object(u.c)(n?n.name:v,{skip:null===n}),f=b.loading,E=b.data,p=b.error;if(f||p)return null;E&&n&&(i=E[n.data]);var g=i.map((function(e){return{value:e.id,label:e.name}})),O=g&&g.find((function(e){return s==e.value})),h=void 0!==s&&O?{value:s,label:O.label}:null;return r.a.createElement("div",{className:"input-wrap"},r.a.createElement("label",{htmlFor:a},t),r.a.createElement(Ee.a,Object.assign({options:g},d,{onCreateOption:function(e){l&&l(a,e)},onChange:function(e){c&&c({target:{name:a,value:e.value}})},value:h,maxMenuHeight:110})))},ve=function(e){var t=new Date(e),a=""+(t.getMonth()+1),n=""+t.getDate(),r=t.getFullYear();return a.length<2&&(a="0"+a),n.length<2&&(n="0"+n),[r,a,n].join("-")};var ge=function(e){var t=e.filter;N();var a=Object(u.c)(ce),l=Object(n.useState)(null),c=Object(Y.a)(l,1)[0],i=Object(n.useState)(null),m=Object(Y.a)(i,2),s=m[0],d=m[1],b=new Map;b.entryType=0,b.createdAt=ve(Date.now())+" 00:00";var f=Object(n.useState)(b),E=Object(Y.a)(f,2),p=E[0],v=E[1],g=Object(u.b)(oe),O=Object(Y.a)(g,2),h=O[0],y=O[1].loading,S=Object(u.b)(ue),w=Object(Y.a)(S,2),k=w[0];Object(me.a)(w[1]);var C=a.data?a.data.entities:[];function x(e){var t=e.target,a=t.value,n=t.name;v(Object(H.a)(Object(H.a)({},p),{},Object(ie.a)({},n,a)))}return c?r.a.createElement(j.a,{to:c}):r.a.createElement("div",null,r.a.createElement("div",{className:"toolbar"},r.a.createElement("div",{className:"titlebar"},r.a.createElement(o.b,{to:"/entries",className:"btn btn-light mr-1"},r.a.createElement(ee,{name:"keyboard_arrow_left"})),r.a.createElement("h5",null,"Register New Entry"))),y&&r.a.createElement("p",null,"Sending ...."),r.a.createElement("form",{className:"form",onSubmit:function(e){e.preventDefault(),p.entity&&p.amount?h({variables:Object(H.a)(Object(H.a)({},p),{},{createdAt:p.createdAt.replace(" ","T")}),refetchQueries:function(){return[{query:le,variables:Object(H.a)(Object(H.a)({},be),{},{filter:t})},{query:le,variables:Object(H.a)(Object(H.a)({},fe),t)}]},awaitRefetchQueries:!0}).then((function(e){console.log(e),v(Object(H.a)(Object(H.a)({},p),{},{amount:"",entity:null})),d({error:!1,text:"Successfully recorded an entry: ".concat(e.data.createEntry.result.id)})}),(function(e){console.log("Error: ",e),d({error:!0,text:"Form submit failed!"})})):d({error:!0,text:"Fill in amount & entity"})},autoComplete:"off"},r.a.createElement("div",null,r.a.createElement(de,{name:"createdAt",label:"Record Date",type:"datetime-local",onChange:x,required:!0,defaultValue:ve(Date.now())+"T00:00"}),r.a.createElement(pe,{name:"entryType",label:"Type",options:[{id:0,name:"Revenue"},{id:1,name:"Expense"}],onChange:x,defaultValue:p.entryType||0,required:!0}),r.a.createElement(pe,{name:"entity",label:"Entity",options:C,onChange:x,onCreateOption:function(e,t){k({variables:{name:t},refetchQueries:function(){return[{query:ce}]},awaitRefetchQueries:!0}).then((function(t){var a=t.data.createEntity.result.id;v(Object(H.a)(Object(H.a)({},p),{},Object(ie.a)({},e,a)))}),(function(e){return d({error:!0,text:"Error creating entity"})}))},defaultValue:p.entity,required:!0}),r.a.createElement(de,{name:"amount",label:"Amount",type:"number",onChange:x,required:!0,value:p.amount,min:100})),r.a.createElement("div",{className:"form-footer"},r.a.createElement("button",null,"Submit"))),s&&r.a.createElement("small",{className:"p-1 message ".concat(s.error?"fail":"success")},s.text))};var Oe=function(e){var t=e.pageNo,a=e.onPageChanged,n=e.lastPage;return r.a.createElement("ul",{className:"pagination"},r.a.createElement("li",{className:"btn-wrap"},r.a.createElement("button",{onClick:function(){a&&a(t>1?t-1:1)},disabled:t<=1},r.a.createElement(ee,{name:"keyboard_arrow_left"})," Previous")),r.a.createElement("li",null,r.a.createElement("span",null,"Page ",t)),r.a.createElement("li",{className:"btn-wrap"},r.a.createElement("button",{onClick:function(){a&&a(t+1)},disabled:n},"Next ",r.a.createElement(ee,{name:"keyboard_arrow_right"}))))};var he=function(e){var t=e.label,a=e.name,n=e.query,l=e.options,c=void 0===l?[]:l,o=Object(se.a)(e,["label","name","query","options"]),i=Object(u.c)(n?n.name:v,{skip:null===n}),m=i.loading,s=i.data,d=i.error;return m||d?null:(s&&n&&(c=s[n.data]),r.a.createElement("div",{className:"input-wrap"},r.a.createElement("label",{htmlFor:a},t),r.a.createElement("select",Object.assign({name:a,id:a},o),r.a.createElement("option",{value:""},"---Select---"),c.map((function(e){return r.a.createElement("option",{key:e.id,value:e.id},e.name)})))))};var ye=function(e){var t=e.fields,a=e.handleChange,n=e.handleSubmit,l=(e.filter,e.handleExport);return r.a.createElement("div",{className:"filter-export  w-100"},r.a.createElement("form",{className:"form d-flex align-bottom",onSubmit:n},r.a.createElement("div",{className:"inline-fields"},t.map((function(e){return e.type&&"select"===e.type?r.a.createElement(he,Object.assign({key:e.name},e,{onChange:a})):r.a.createElement(de,Object.assign({key:e.name},e,{onChange:a}))}))),r.a.createElement("div",{className:"d-flex"},r.a.createElement("button",{name:"filter"},"Filter"),r.a.createElement("button",{className:"ml-1",name:"export",type:"button",onClick:l},"Export"))))};var je=function(e){var t=e.handleSubmit,a=e.handleExport,l=e.filter,c=void 0===l?{}:l;console.log(c);var o=Object(n.useState)(c),u=Object(Y.a)(o,2),i=u[0],m=u[1],s=[{name:"entity",label:"Entity",type:"select",query:{name:ce,data:"entities"},defaultValue:c.entity},{name:"dateFrom",label:"From",type:"date",defaultValue:ve(Date.now())},{name:"dateTo",label:"To",type:"date",defaultValue:ve(Date.now())}];return r.a.createElement(ye,{handleSubmit:function(e){e.preventDefault(),t(i)},fields:s,handleChange:function(e){var t=e.target,a=t.value,n=t.name;m(Object(H.a)(Object(H.a)({},i),{},Object(ie.a)({},n,a||null)))},handleExport:function(e){e.preventDefault(),a(i)}})};var Ne=function(e){var t=e.filter,a=Object(u.a)(le,{variables:Object(H.a)(Object(H.a)({},fe),t)}),l=Object(Y.a)(a,2),c=l[0],o=l[1],i=o.loading,m=o.data,s=o.error;if(Object(n.useEffect)((function(){var e=new AbortController;return c(),function(){e.abort()}}),[t]),i||i)return r.a.createElement("p",null,"Loading...");if(s||s)return r.a.createElement("p",null,"Error :(");var d=m?m.entries.filter((function(e){return 0===e.entryType})):[],b=m?m.entries.filter((function(e){return 1===e.entryType})):[],f=d.reduce((function(e,t){return e+t.amount}),0),E=b.reduce((function(e,t){return e+t.amount}),0),p=f-E;return r.a.createElement("div",{className:"summary"},r.a.createElement("h5",null,"Summary"),r.a.createElement("div",null,r.a.createElement("div",null,"Revenue: ",r.a.createElement("br",null),r.a.createElement("i",null,r.a.createElement("small",null,d.length," record(s)")))," ",r.a.createElement("span",null,U.fmt(f))),r.a.createElement("div",null,r.a.createElement("div",null,"Expense:",r.a.createElement("br",null),r.a.createElement("i",null,r.a.createElement("small",null,b.length," record(s)"))," "),r.a.createElement("span",null,U.fmt(E))),r.a.createElement("hr",null),r.a.createElement("div",null,"Balance: ",r.a.createElement("span",null,U.fmt(p))))};var Se=function(){N();var e=Object(n.useState)(1),t=Object(Y.a)(e,2),a=t[0],l=t[1],c=Object(n.useState)(new Map),i=Object(Y.a)(c,2),m=i[0],s=i[1],d=Object(u.a)(le,{variables:Object(H.a)({pageSize:10,pageNo:a},m)}),b=Object(Y.a)(d,2),f=b[0],E=b[1],p=(E.loading,E.data);E.error,Object(n.useEffect)((function(){var e=new AbortController;return console.log("Start"),f(),function(){e.abort()}}),[a,m]);var v=function(e){var t=Date.parse(e);return new Date(t).toLocaleDateString("en-GB")},g=p?p.entries.map((function(e){return Object(H.a)(Object(H.a)({},e),{},{entity_name:e.entity.name,createdAt:v(e.createdAt),updatedAt:v(e.updatedAt),amount:U.fmt(e.amount),entryType:0===e.entryType?"Revenue":"Expense"})})):[];return r.a.createElement(r.a.Fragment,null,r.a.createElement(j.b,{path:"/entries",exact:!0},r.a.createElement("div",{className:"toolbar"},r.a.createElement("h5",null,"List of entries"),r.a.createElement(o.b,{className:"d-flex btn has-left-icon",to:"/entries/new-entry"},r.a.createElement(ee,{name:"add",text:"New Entry"}))),r.a.createElement("hr",null),r.a.createElement("div",{className:"toolbar"},p&&r.a.createElement(je,{handleSubmit:function(e){console.log(e);for(var t=new Map,a=0,n=Object.entries(e);a<n.length;a++){var r=Object(Y.a)(n[a],2),c=r[0],o=r[1];o&&(t[c]=o)}console.log("Params: ",t),s(t),l(1)},filter:m,handleExport:function(e){for(var t=new Map,a=0,n=Object.entries(e);a<n.length;a++){var r=Object(Y.a)(n[a],2),l=r[0],c=r[1];c&&(t[l]=c)}var o=Object.keys(t).map((function(e){return e+"="+t[e]})).join("&");fetch("".concat(w,"/export-entries?").concat(o)).then((function(e){return e.blob()})).then((function(e){var t=window.URL.createObjectURL(e),a=document.createElement("a");a.href=t,a.download="Export.xlsx",document.body.appendChild(a),a.click(),a.remove()}))}})),r.a.createElement("div",{className:"d-flex desktop"},r.a.createElement("div",{className:"d-flex-main"},r.a.createElement(X,{columns:[{name:"id",label:"ID"},{name:"entity_name",label:"Entity"},{name:"amount",label:"Amount"},{name:"entryType",label:"Entry Type"},{name:"createdAt",label:"Created"}],data:g}),p&&r.a.createElement(Oe,{pageNo:a,onPageChanged:function(e){l(e)},lastPage:p.entries.length<10})),r.a.createElement(Ne,{filter:m}))),r.a.createElement(j.b,{path:"/entries/new-entry",exact:!0},r.a.createElement(ge,{filter:m})))};var we=function(){var e=Object(n.useState)(null),t=Object(Y.a)(e,2),a=t[0],l=t[1],c=Object(n.useState)(new Map),i=Object(Y.a)(c,2),m=i[0],s=i[1],d=Object(u.b)(O),b=Object(Y.a)(d,2),f=b[0],E=b[1].loading;function p(e){var t=e.target,a=t.value,n=t.name;s(Object(H.a)(Object(H.a)({},m),{},Object(ie.a)({},n,a)))}return a?r.a.createElement(j.a,{to:a}):r.a.createElement("div",null,r.a.createElement("div",{className:"toolbar"},r.a.createElement("div",{className:"titlebar"},r.a.createElement(o.b,{to:"/users",className:"btn btn-light mr-1"},r.a.createElement(ee,{name:"keyboard_arrow_left"})),r.a.createElement("h5",null,"Register New User"))),E&&r.a.createElement("p",null,"Sending ...."),r.a.createElement("form",{className:"form form-medium",onSubmit:function(e){e.preventDefault(),f({variables:Object(H.a)({},m),refetchQueries:[{query:g},{query:v}]}).then((function(){return l("/users")}),(function(e){return console.log("Error: ",e)}))}},r.a.createElement("div",null,r.a.createElement(de,{name:"username",label:"Username",onChange:p,required:!0}),r.a.createElement(de,{name:"email",label:"Email Address",onChange:p,type:"email",required:!0}),r.a.createElement(de,{name:"firstName",label:"First Name",onChange:p,required:!0}),r.a.createElement(de,{name:"lastName",label:"Last Name",onChange:p,required:!0})),r.a.createElement("div",{className:"form-footer"},r.a.createElement("button",null,"Submit"))))};var ke=Object(j.h)((function(e){var t=e.match,a=Object(n.useState)(null),l=Object(Y.a)(a,2),c=l[0],i=l[1],m=Object(n.useState)(new Map),s=Object(Y.a)(m,2),d=s[0],b=s[1],f=Object(u.b)(O),E=Object(Y.a)(f,2),p=E[0];Object(me.a)(E[1]);var y=Object(u.c)(h,{variables:{id:t.params.id}}),N=y.loading,S=y.error,w=y.data;if(N)return r.a.createElement("p",null,"Loading...");if(S)return r.a.createElement("p",null,"Error :(");var k=w.user;function C(e){var t=e.target,a=t.value,n=t.name;b(Object(H.a)(Object(H.a)({},d),{},Object(ie.a)({},n,a)))}return c?r.a.createElement(j.a,{to:c}):r.a.createElement("div",null,r.a.createElement("div",{className:"toolbar"},r.a.createElement("div",{className:"titlebar"},r.a.createElement(o.b,{to:"/users",className:"btn btn-light mr-1"},r.a.createElement(ee,{name:"keyboard_arrow_left"})),r.a.createElement("h5",null,"Update User"))),N&&r.a.createElement("p",null,"Sending ...."),r.a.createElement("form",{className:"form form-medium",onSubmit:function(e){e.preventDefault();var t=new Map;Object.keys(k).forEach((function(e){d[e]||(t[e]=k[e])})),p({variables:Object(H.a)(Object(H.a)(Object(H.a)({},d),t),{},{id:k.id}),refetchQueries:[{query:g},{query:v}]}).then((function(){return i("/users")}),(function(e){return console.log("Error: ",e)}))}},r.a.createElement("div",null,r.a.createElement(de,{name:"username",label:"Username",onChange:C,required:!0,defaultValue:k.username,readOnly:!0}),r.a.createElement(de,{name:"email",label:"Email Address",onChange:C,type:"email",required:!0,defaultValue:k.email}),r.a.createElement(de,{name:"firstName",label:"First Name",onChange:C,required:!0,defaultValue:k.firstName}),r.a.createElement(de,{name:"lastName",label:"Last Name",onChange:C,required:!0,defaultValue:k.lastName})),r.a.createElement("div",{className:"form-footer"},r.a.createElement("button",null,"Submit"))))}));var Ce=function(e){N();var t=Object(u.c)(g),a=t.loading,n=t.error,l=t.data;if(a)return null;if(n)return r.a.createElement("p",null,"Error (:");var c=[{name:"id",label:"ID"},{name:"username",label:"Client Name"},{name:"email",label:"Email"},{name:"name",label:"Full Name"},{name:"actions",label:"",render:function(e){return r.a.createElement("div",null,r.a.createElement("a",{href:"/users/update/".concat(e.id),className:"d-flex align-left"},r.a.createElement(ee,{name:"edit",text:"Edit"})))}}],i=l.users.map((function(e){return Object(H.a)(Object(H.a)({},e),{},{name:e.firstName?"".concat(e.firstName," ").concat(e.lastName):null})}));return r.a.createElement(r.a.Fragment,null,r.a.createElement(j.b,{path:"/users",exact:!0},r.a.createElement("div",{className:"toolbar"},r.a.createElement("h5",null,"List of users"),r.a.createElement(o.b,{className:"d-flex btn btn-light has-left-icon",to:"/users/new-user"},r.a.createElement(ee,{name:"add",text:"New User"}))),r.a.createElement(X,{columns:c,data:i})),r.a.createElement(j.b,{path:"/users/new-user",exact:!0},r.a.createElement(we,null)),r.a.createElement(j.b,{path:"/users/update/:id",exact:!0},r.a.createElement(ke,null)))},xe={saveToken:function(e,t){sessionStorage.setItem("AccessToken",e),t(!0)},getToken:function(){return sessionStorage.getItem("AccessToken")},removeToken:function(){return sessionStorage.removeItem("AccessToken")}};var Ae=function(e){var t=Object(n.useState)(new Map),a=Object(Y.a)(t,2),l=a[0],c=a[1],o=Object(n.useState)(null),i=Object(Y.a)(o,2),m=i[0],s=i[1],d=Object(u.b)(p),b=Object(Y.a)(d,2),f=b[0],E=b[1].client;function v(e){var t=e.target,a=t.value,n=t.name;c(Object(H.a)(Object(H.a)({},l),{},Object(ie.a)({},n,a)))}return m?r.a.createElement(j.a,{to:m}):r.a.createElement(r.a.Fragment,null,r.a.createElement("div",{className:"login-page box-shadow"},r.a.createElement("div",{className:"login-header d-flex mb-1 p-1"},r.a.createElement("h3",null,"TAG MAKOKA (MSCC)"),r.a.createElement("img",{src:"/static/images/logo.png",alt:"Logo"})),r.a.createElement("form",{className:"form",onSubmit:function(e){e.preventDefault(),E.clearStore(),f({variables:Object(H.a)({},l)}).then((function(e){if(e.data){var t=e.data.tokenAuth.token;xe.saveToken(t,(function(){s("/")}))}}),(function(e){return console.log("Error: ",e)}))}},r.a.createElement("div",{className:"mt-1"},r.a.createElement(de,{name:"username",label:"Username",onChange:v,required:!0}),r.a.createElement(de,{name:"password",label:"Password",type:"password",onChange:v,required:!0})),r.a.createElement("div",{className:"form-footer"},r.a.createElement("button",null,r.a.createElement("span",{className:"mr-1"},"Login"),r.a.createElement(ee,{name:"login"}))))))},$e=function(){var e=xe.getToken();return e?"JWT ".concat(e):""},qe=new m.a({uri:"".concat(w,"/graphql"),request:function(e){e.setContext({headers:{Authorization:$e()}})}});var Te=function(){return r.a.createElement(o.a,null,r.a.createElement(W.a,{client:qe},r.a.createElement(j.d,null,r.a.createElement(j.b,{path:"/login",exact:!0},r.a.createElement(Ae,null)),r.a.createElement(j.b,{path:"/"},r.a.createElement(k,null),r.a.createElement("section",{className:"page-content container"},r.a.createElement("div",{className:"content"},r.a.createElement(j.d,null,r.a.createElement(j.b,{path:"/",exact:!0},r.a.createElement(G,null)),r.a.createElement(j.b,{path:"/entries"},r.a.createElement(Se,null)),r.a.createElement(j.b,{path:"/users"},r.a.createElement(Ce,null)))))))))};Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));c.a.render(r.a.createElement(r.a.StrictMode,null,r.a.createElement(Te,null)),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then((function(e){e.unregister()})).catch((function(e){console.error(e.message)}))}},[[52,1,2]]]);
//# sourceMappingURL=main.4406a226.chunk.js.map